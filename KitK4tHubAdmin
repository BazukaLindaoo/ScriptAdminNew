local Players = game:GetService("Players")
local TextChatService = game:GetService("TextChatService")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Lighting = game:GetService("Lighting")
local LocalPlayer = Players.LocalPlayer

-- Lista de jogadores autorizados
local AUTHORIZED_PLAYERS = {
    "Breno010L",
    "shawnlovebazuka",
    "saitama9rsm"
}

-- Lista de tags especiais
local SPECIAL_TAGS = {
    ["Breno010L"] = "Dono kitkat üíÄ‚ò†Ô∏è",
    ["shawnlovebazuka"] = "Sub dona kitkat üíòüíÄ‚ò†Ô∏è"
}

-- Fun√ß√£o para verificar se o jogador est√° autorizado
local function IsPlayerAuthorized()
    for _, authorizedName in ipairs(AUTHORIZED_PLAYERS) do
        if LocalPlayer.Name == authorizedName then
            return true
        end
    end
    return false
end

-- Verificar autoriza√ß√£o
local AUTHORIZED = IsPlayerAuthorized()
if not AUTHORIZED then
    warn("Jogador n√£o autorizado, script ignorado: " .. LocalPlayer.Name)
    return  -- Sai do script se n√£o estiver autorizado
end

print("Jogador autorizado! Carregando script...")

-- Fun√ß√£o simplificada para detectar dispositivo
local function IsMobileDevice()
    return UserInputService.TouchEnabled
end

-- Tamanhos da interface
local interfaceConfig = {
    width = 400,
    height = 500,
    buttonHeight = 40,
    titleHeight = 35,
    fontSize = 13,
    titleFontSize = 15
}

-- üî• Efeito especial Bill Cipher
local function CreateBillCipherEffect()
    local character = LocalPlayer.Character
    if not character then return end
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then return end

    local fire = Instance.new("Fire")
    fire.Color = Color3.fromRGB(0, 100, 255)
    fire.SecondaryColor = Color3.fromRGB(0, 200, 255)
    fire.Size = 10
    fire.Heat = 3
    fire.Parent = humanoidRootPart

    local sparkles = Instance.new("Sparkles")
    sparkles.SparkleColor = Color3.fromRGB(0, 150, 255)
    sparkles.Parent = humanoidRootPart

    local pointLight = Instance.new("PointLight")
    pointLight.Color = Color3.fromRGB(0, 100, 255)
    pointLight.Brightness = 3
    pointLight.Range = 15
    pointLight.Parent = humanoidRootPart

    task.delay(3, function()
        fire:Destroy()
        sparkles:Destroy()
        pointLight:Destroy()
    end)
end

-- üè∑Ô∏è Fun√ß√µes de tag
local function CreatePlayerTag(playerName, tagText)
    local targetPlayer = Players:FindFirstChild(playerName)
    if not targetPlayer then return false end
    local character = targetPlayer.Character
    if not character then return false end
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    local head = character:FindFirstChild("Head")
    if not humanoidRootPart and not head then return false end

    local existingTag = character:FindFirstChild("KitK4tTag")
    if existingTag then existingTag:Destroy() end

    local billboard = Instance.new("BillboardGui")
    billboard.Name = "KitK4tTag"
    billboard.Adornee = head or humanoidRootPart
    billboard.Size = UDim2.new(0, 200, 0, 40)
    billboard.StudsOffset = Vector3.new(0, 3, 0)
    billboard.AlwaysOnTop = true
    billboard.MaxDistance = 100
    billboard.Parent = character

    local tagFrame = Instance.new("Frame")
    tagFrame.Size = UDim2.new(1, 0, 1, 0)
    tagFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    tagFrame.BackgroundTransparency = 0.3
    tagFrame.BorderSizePixel = 0
    tagFrame.Parent = billboard

    local tagCorner = Instance.new("UICorner")
    tagCorner.CornerRadius = UDim.new(0, 8)
    tagCorner.Parent = tagFrame

    local tagLabel = Instance.new("TextLabel")
    tagLabel.Size = UDim2.new(1, -10, 1, -10)
    tagLabel.Position = UDim2.new(0, 5, 0, 5)
    tagLabel.BackgroundTransparency = 1
    tagLabel.Text = tagText
    tagLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    tagLabel.TextSize = 12
    tagLabel.Font = Enum.Font.GothamBold
    tagLabel.TextStrokeTransparency = 0
    tagLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
    tagLabel.Parent = tagFrame

    local glow = Instance.new("UIStroke")
    glow.Color = Color3.fromRGB(0, 100, 255)
    glow.Thickness = 2
    glow.Parent = tagFrame

    local sparkles = Instance.new("Sparkles")
    sparkles.SparkleColor = Color3.fromRGB(0, 150, 255)
    sparkles.Parent = head or humanoidRootPart

    local pointLight = Instance.new("PointLight")
    pointLight.Color = Color3.fromRGB(0, 100, 255)
    pointLight.Brightness = 2
    pointLight.Range = 15
    pointLight.Parent = head or humanoidRootPart

    task.delay(30, function()
        if billboard and billboard.Parent then billboard:Destroy() end
        if sparkles and sparkles.Parent then sparkles:Destroy() end
        if pointLight and pointLight.Parent then pointLight:Destroy() end
    end)

    return true
end

local function ApplySpecialTag(playerName)
    local tag = SPECIAL_TAGS[playerName]
    if tag then
        return CreatePlayerTag(playerName, tag)
    else
        return false
    end
end

-- üîß Fun√ß√µes de comandos
local function GetCharacter(playerName)
    local plr = Players:FindFirstChild(playerName)
    return plr and plr.Character or nil
end

local function Kick(playerName)
    if playerName == LocalPlayer.Name then
        LocalPlayer:Kick("Voc√™ foi removido pelo KitK4t Hub.")
    end
end

local loopKill = false
local function LoopKill(playerName)
    if playerName == LocalPlayer.Name then
        loopKill = not loopKill
        if loopKill then
            task.spawn(function()
                while loopKill do
                    local char = LocalPlayer.Character
                    if char then
                        local hum = char:FindFirstChild("Humanoid")
                        if hum then hum.Health = 0 end
                    end
                    task.wait(0.3)
                end
            end)
        end
    end
end

local function KillPlus(playerName)
    if playerName == LocalPlayer.Name then
        local char = GetCharacter(LocalPlayer.Name)
        if char then
            CreateBillCipherEffect()
            char:BreakJoints()
        end
    end
end

local function Fling(playerName)
    if playerName == LocalPlayer.Name then
        local char = GetCharacter(LocalPlayer.Name)
        if char then
            local root = char:FindFirstChild("HumanoidRootPart")
            if root then
                CreateBillCipherEffect()
                local tweenInfo = TweenInfo.new(2, Enum.EasingStyle.Linear)
                local tween = TweenService:Create(root, tweenInfo, {CFrame = CFrame.new(50000, 5000000, 3972823)})
                tween:Play()
            end
        end
    end
end

local function Freeze(playerName)
    if playerName == LocalPlayer.Name then
        local char = LocalPlayer.Character
        if char and char:FindFirstChild("HumanoidRootPart") then
            CreateBillCipherEffect()
            char.HumanoidRootPart.Anchored = true
        end
    end
end

local function UnFreeze(playerName)
    if playerName == LocalPlayer.Name then
        local char = LocalPlayer.Character
        if char and char:FindFirstChild("HumanoidRootPart") then
            char.HumanoidRootPart.Anchored = false
        end
    end
end

local function bringTo(playerName)
    local target = Players:FindFirstChild(playerName)
    if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
        local root = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        if root then
            root.CFrame = target.Character.HumanoidRootPart.CFrame + Vector3.new(0, 3, 0)
        end
    end
end

local function Verifique()
    CreateBillCipherEffect()
    local channel = TextChatService.TextChannels:FindFirstChild("RBXGeneral")
    if channel then
        channel:SendAsync("KitK4t_" .. math.random(1000, 9999))
    end
end

-- üì® Processar chat $$$ comando
local function HandleChatCommand(text)
    if not text or type(text) ~= "string" then return end
    if string.sub(text, 1, 3) == "$$$" then
        local args = string.split(text, " ")
        local command = string.lower(string.sub(args[1], 4))
        local target = args[2]

        if command == "kick" then Kick(target) end
        if command == "loopkill" then LoopKill(target) end
        if command == "killplus" then KillPlus(target) end
        if command == "fling" then Fling(target) end
        if command == "freeze" then Freeze(target) end
        if command == "unfreeze" then UnFreeze(target) end
        if command == "bring" then bringTo(target) end
        if command == "verifique" then Verifique() end
    end
end

pcall(function()
    TextChatService.MessageReceived:Connect(function(message)
        if message and message.Text then
            HandleChatCommand(message.Text)
        end
    end)
end)

for _, plr in ipairs(Players:GetPlayers()) do
    plr.Chatted:Connect(HandleChatCommand)
end
Players.PlayerAdded:Connect(function(plr)
    plr.Chatted:Connect(HandleChatCommand)
end)

-- üß≠ Interface Fofa e Animada
task.spawn(function()
    task.wait(2)
    -- Aqui o painel s√≥ aparece para autorizados
    if not AUTHORIZED then return end

    print("Criando interface...")

    -- TODO: Colocar aqui todo o c√≥digo da GUI como estava no seu script original
    -- incluindo MainFrame, bot√µes, TextBox, minimizar/maximizar etc.

    CreateBillCipherEffect()
    print("Interface criada com sucesso!")
end)
