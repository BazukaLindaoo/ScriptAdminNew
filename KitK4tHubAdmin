local Players = game:GetService("Players")
local TextChatService = game:GetService("TextChatService")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Lighting = game:GetService("Lighting")
local LocalPlayer = Players.LocalPlayer

-- Lista de jogadores autorizados
local AUTHORIZED_PLAYERS = {
    "Breno010L",
    "shawnlovebazuka",
    "ziovxoo",
    "Kay_g4m4",
    "gabi6kkjj",
    "beatrizz2317",
    "ACNDIEGO",
    "saitama9rsm",
    "Faxcarioca"
}

-- Lista de tags especiais
local SPECIAL_TAGS = {
    ["Breno010L"] = "Dono KitK4t",
    ["shawnlovebazuka"] = "Sub dona KitK4t"
}

-- Armazenar tags personalizadas
local ActiveTags = {}

-- Configura√ß√µes de cores
local THEME_COLORS = {
    azul = {
        primary = Color3.fromRGB(0, 100, 255),
        secondary = Color3.fromRGB(0, 150, 255),
        background = Color3.fromRGB(25, 25, 45),
        text = Color3.fromRGB(255, 255, 255),
        fire_color = Color3.fromRGB(0, 100, 255),
        fire_secondary = Color3.fromRGB(0, 200, 255)
    },
    verde = {
        primary = Color3.fromRGB(0, 255, 100),
        secondary = Color3.fromRGB(100, 255, 150),
        background = Color3.fromRGB(25, 45, 25),
        text = Color3.fromRGB(255, 255, 255),
        fire_color = Color3.fromRGB(0, 255, 100),
        fire_secondary = Color3.fromRGB(100, 255, 150)
    },
    preto = {
        primary = Color3.fromRGB(50, 50, 50),
        secondary = Color3.fromRGB(100, 100, 100),
        background = Color3.fromRGB(15, 15, 15),
        text = Color3.fromRGB(255, 255, 255),
        fire_color = Color3.fromRGB(255, 255, 255),
        fire_secondary = Color3.fromRGB(200, 200, 200)
    },
    transparente = {
        primary = Color3.fromRGB(255, 182, 193),
        secondary = Color3.fromRGB(255, 105, 180),
        background = Color3.fromRGB(255, 240, 245),
        text = Color3.fromRGB(75, 75, 75),
        fire_color = Color3.fromRGB(255, 182, 193),
        fire_secondary = Color3.fromRGB(255, 105, 180)
    }
}

-- Vari√°veis globais
local SelectedDevice = "mobile"
local SelectedColor = "transparente"
local CurrentTheme = THEME_COLORS.transparente

-- Fun√ß√£o para verificar se o jogador est√° autorizado
local function IsPlayerAuthorized()
    for _, authorizedName in ipairs(AUTHORIZED_PLAYERS) do
        if LocalPlayer.Name == authorizedName then
            return true
        end
    end
    return false
end

-- Se o jogador n√£o estiver autorizado, n√£o executa o script
if not IsPlayerAuthorized() then
    return
end

-- Tamanhos da interface baseados no dispositivo
local function GetInterfaceConfig(device)
    if device == "pc" then
        return {
            width = 400,
            height = 500,
            buttonHeight = 40,
            titleHeight = 45,
            fontSize = 14,
            titleFontSize = 16
        }
    else
        return {
            width = 320,
            height = 420,
            buttonHeight = 36,
            titleHeight = 40,
            fontSize = 12,
            titleFontSize = 14
        }
    end
end

-- Fun√ß√£o para autocompletar nomes
local function AutoCompleteName(partialName)
    if partialName == "" then return nil end
    
    local lowerPartial = string.lower(partialName)
    local allPlayers = Players:GetPlayers()
    
    -- Primeiro procura nos jogadores autorizados
    for _, authorizedName in ipairs(AUTHORIZED_PLAYERS) do
        if string.lower(authorizedName):sub(1, #lowerPartial) == lowerPartial then
            return authorizedName
        end
    end
    
    -- Depois procura em todos os jogadores online
    for _, player in ipairs(allPlayers) do
        if player ~= LocalPlayer then
            local playerName = player.Name
            if string.lower(playerName):sub(1, #lowerPartial) == lowerPartial then
                return playerName
            end
        end
    end
    
    return nil
end

-- Efeito especial de fogo baseado na cor selecionada
local function CreateThemeEffect()
    local character = LocalPlayer.Character
    if not character then return end
    
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then return end

    local fire = Instance.new("Fire")
    fire.Name = "ThemeFire"
    fire.Color = CurrentTheme.fire_color
    fire.SecondaryColor = CurrentTheme.fire_secondary
    fire.Size = 8
    fire.Heat = 2
    fire.Parent = humanoidRootPart

    task.delay(2, function()
        if fire then fire:Destroy() end
    end)
end

-- Fun√ß√£o para criar tag acima da cabe√ßa do jogador
local function CreatePlayerTag(playerName, tagText)
    local targetPlayer = Players:FindFirstChild(playerName)
    if not targetPlayer then return false end
    
    local character = targetPlayer.Character
    if not character then return false end
    
    local head = character:FindFirstChild("Head")
    if not head then return false end
    
    -- Remover tag anterior se existir
    RemovePlayerTag(playerName)
    
    -- Criar BillboardGui para a tag
    local billboard = Instance.new("BillboardGui")
    billboard.Name = "KitK4tTag"
    billboard.Adornee = head
    billboard.Size = UDim2.new(0, 150, 0, 30)
    billboard.StudsOffset = Vector3.new(0, 2.5, 0)
    billboard.AlwaysOnTop = true
    billboard.MaxDistance = 80
    billboard.Parent = character
    
    -- Frame principal da tag
    local tagFrame = Instance.new("Frame")
    tagFrame.Size = UDim2.new(1, 0, 1, 0)
    tagFrame.BackgroundColor3 = CurrentTheme.primary
    tagFrame.BackgroundTransparency = 0.2
    tagFrame.BorderSizePixel = 0
    tagFrame.Parent = billboard
    
    local tagCorner = Instance.new("UICorner")
    tagCorner.CornerRadius = UDim.new(0, 12)
    tagCorner.Parent = tagFrame
    
    -- Texto da tag
    local tagLabel = Instance.new("TextLabel")
    tagLabel.Size = UDim2.new(1, -8, 1, -8)
    tagLabel.Position = UDim2.new(0, 4, 0, 4)
    tagLabel.BackgroundTransparency = 1
    tagLabel.Text = tagText
    tagLabel.TextColor3 = CurrentTheme.text
    tagLabel.TextSize = 10
    tagLabel.Font = Enum.Font.GothamBold
    tagLabel.TextStrokeTransparency = 0
    tagLabel.TextStrokeColor3 = CurrentTheme.secondary
    tagLabel.Parent = tagFrame
    
    -- Efeito de brilho
    local glow = Instance.new("UIStroke")
    glow.Color = CurrentTheme.secondary
    glow.Thickness = 2
    glow.Parent = tagFrame
    
    -- Salvar tag ativa
    ActiveTags[playerName] = {
        Billboard = billboard,
        TagText = tagText
    }
    
    return true
end

-- Fun√ß√£o para remover tag
local function RemovePlayerTag(playerName)
    if ActiveTags[playerName] then
        local tagData = ActiveTags[playerName]
        if tagData.Billboard and tagData.Billboard.Parent then
            tagData.Billboard:Destroy()
        end
        ActiveTags[playerName] = nil
        return true
    end
    return false
end

-- Fun√ß√£o para aplicar tag especial
local function ApplySpecialTag(playerName)
    local tag = SPECIAL_TAGS[playerName]
    if tag then
        return CreatePlayerTag(playerName, tag)
    end
    return false
end

-- Fun√ß√£o para aplicar tag personalizada
local function ApplyCustomTag(playerName, customTag)
    if customTag and customTag ~= "" then
        return CreatePlayerTag(playerName, customTag)
    end
    return false
end

-- Envia comandos via chat
local function SendCommandMessage(command, target)
    CreateThemeEffect()
    
    local channel = TextChatService.TextChannels:FindFirstChild("RBXGeneral")
    if channel then
        local msg = "$$$" .. command
        if target then msg = msg .. " " .. target end
        channel:SendAsync(msg)
    else
        local msg = "$$$" .. command .. (target and (" " .. target) or "")
        game:GetService("ReplicatedStorage"):WaitForChild("DefaultChatSystemChatEvents")
            .SayMessageRequest:FireServer(msg, "All")
    end
end

-- Obter personagem
local function GetCharacter(playerName)
    local plr = Players:FindFirstChild(playerName)
    return plr and plr.Character or nil
end

-- Fun√ß√µes de comandos b√°sicas
local function Kick(playerName)
    if playerName == LocalPlayer.Name then
        LocalPlayer:Kick("Voc√™ foi removido pelo KitK4t Hub.")
    end
end

local loopKill = false
local function LoopKill(playerName)
    if playerName == LocalPlayer.Name then
        loopKill = not loopKill
        if loopKill then
            task.spawn(function()
                while loopKill do
                    if LocalPlayer.Character then
                        local hum = LocalPlayer.Character:FindFirstChild("Humanoid")
                        if hum then hum.Health = 0 end
                    end
                    task.wait(0.3)
                end
            end)
        end
    end
end

local function KillPlus(playerName)
    if playerName == LocalPlayer.Name then
        local char = GetCharacter(LocalPlayer.Name)
        if char then
            CreateThemeEffect()
            char:BreakJoints()
        end
    end
end

local function Fling(playerName)
    if playerName == LocalPlayer.Name then
        local char = GetCharacter(LocalPlayer.Name)
        if char then
            local root = char:FindFirstChild("HumanoidRootPart")
            if root then
                CreateThemeEffect()
                local tweenInfo = TweenInfo.new(2, Enum.EasingStyle.Linear)
                local tween = TweenService:Create(root, tweenInfo, {CFrame = CFrame.new(50000, 5000000, 3972823)})
                tween:Play()
            end
        end
    end
end

local function Freeze(playerName)
    if playerName == LocalPlayer.Name then
        local char = LocalPlayer.Character
        if char and char:FindFirstChild("HumanoidRootPart") then
            CreateThemeEffect()
            char.HumanoidRootPart.Anchored = true
        end
    end
end

local function UnFreeze(playerName)
    if playerName == LocalPlayer.Name then
        local char = LocalPlayer.Character
        if char and char:FindFirstChild("HumanoidRootPart") then
            char.HumanoidRootPart.Anchored = false
        end
    end
end

local function Bring(playerName)
    local target = Players:FindFirstChild(playerName)
    if target and target.Character and LocalPlayer.Character then
        local targetRoot = target.Character:FindFirstChild("HumanoidRootPart")
        local localRoot = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        if targetRoot and localRoot then
            CreateThemeEffect()
            targetRoot.CFrame = localRoot.CFrame + Vector3.new(0, 3, 0)
        end
    end
end

local function Verifique()
    CreateThemeEffect()
    local channel = TextChatService.TextChannels:FindFirstChild("RBXGeneral")
    if channel then
        channel:SendAsync("KitK4t_" .. math.random(1000, 9999))
    end
end

-- Processar comandos do chat
local function HandleChatCommand(text)
    if not text or type(text) ~= "string" then return end
    if string.sub(text, 1, 3) == "$$$" then
        local args = string.split(text, " ")
        local command = string.lower(string.sub(args[1], 4))
        local target = args[2]

        if command == "kick" then Kick(target) end
        if command == "loopkill" then LoopKill(target) end
        if command == "killplus" then KillPlus(target) end
        if command == "fling" then Fling(target) end
        if command == "freeze" then Freeze(target) end
        if command == "unfreeze" then UnFreeze(target) end
        if command == "bring" then Bring(target) end
        if command == "verifique" then Verifique() end
    end
end

-- Sistema de chat
pcall(function()
    TextChatService.MessageReceived:Connect(function(message)
        if message and message.Text then
            HandleChatCommand(message.Text)
        end
    end)
end)

for _, plr in ipairs(Players:GetPlayers()) do
    plr.Chatted:Connect(HandleChatCommand)
end
Players.PlayerAdded:Connect(function(plr)
    plr.Chatted:Connect(HandleChatCommand)
end)

-- üéÆ TELA DE SELE√á√ÉO DE DISPOSITIVO
local function CreateDeviceSelectionScreen()
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "DeviceSelectionScreen"
    ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
    ScreenGui.ResetOnSpawn = false

    -- Fundo preto
    local BlackBackground = Instance.new("Frame")
    BlackBackground.Size = UDim2.new(1, 0, 1, 0)
    BlackBackground.Position = UDim2.new(0, 0, 0, 0)
    BlackBackground.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    BlackBackground.BackgroundTransparency = 0.2
    BlackBackground.BorderSizePixel = 0
    BlackBackground.ZIndex = 1
    BlackBackground.Parent = ScreenGui

    -- Frame principal
    local MainFrame = Instance.new("Frame")
    MainFrame.Name = "MainFrame"
    MainFrame.Size = UDim2.new(0, 300, 0, 200)
    MainFrame.Position = UDim2.new(0.5, -150, 0.5, -100)
    MainFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    MainFrame.BorderSizePixel = 0
    MainFrame.ClipsDescendants = true
    MainFrame.ZIndex = 2
    MainFrame.Parent = ScreenGui

    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, 20)
    UICorner.Parent = MainFrame

    local UIStroke = Instance.new("UIStroke")
    UIStroke.Color = Color3.fromRGB(100, 100, 255)
    UIStroke.Thickness = 3
    UIStroke.Parent = MainFrame

    -- T√≠tulo
    local TitleLabel = Instance.new("TextLabel")
    TitleLabel.Size = UDim2.new(1, -20, 0, 50)
    TitleLabel.Position = UDim2.new(0, 10, 0, 10)
    TitleLabel.BackgroundTransparency = 1
    TitleLabel.Text = "üì± Selecione seu Dispositivo üì±"
    TitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    TitleLabel.TextSize = 16
    TitleLabel.Font = Enum.Font.GothamBold
    TitleLabel.ZIndex = 3
    TitleLabel.Parent = MainFrame

    -- Bot√£o Mobile
    local MobileButton = Instance.new("TextButton")
    MobileButton.Name = "MobileButton"
    MobileButton.Size = UDim2.new(0.8, 0, 0, 45)
    MobileButton.Position = UDim2.new(0.1, 0, 0.4, 0)
    MobileButton.BackgroundColor3 = Color3.fromRGB(100, 100, 255)
    MobileButton.BorderSizePixel = 0
    MobileButton.Text = "üì± Mobile"
    MobileButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    MobileButton.TextSize = 14
    MobileButton.Font = Enum.Font.GothamBold
    MobileButton.ZIndex = 3
    MobileButton.Parent = MainFrame

    local MobileCorner = Instance.new("UICorner")
    MobileCorner.CornerRadius = UDim.new(0, 12)
    MobileCorner.Parent = MobileButton

    -- Bot√£o PC
    local PCButton = Instance.new("TextButton")
    PCButton.Name = "PCButton"
    PCButton.Size = UDim2.new(0.8, 0, 0, 45)
    PCButton.Position = UDim2.new(0.1, 0, 0.7, 0)
    PCButton.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
    PCButton.BorderSizePixel = 0
    PCButton.Text = "üíª PC"
    PCButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    PCButton.TextSize = 14
    PCButton.Font = Enum.Font.GothamBold
    PCButton.ZIndex = 3
    PCButton.Parent = MainFrame

    local PCCorner = Instance.new("UICorner")
    PCCorner.CornerRadius = UDim.new(0, 12)
    PCCorner.Parent = PCButton

    -- Fun√ß√£o para selecionar dispositivo
    local function SelectDevice(device)
        SelectedDevice = device
        ScreenGui:Destroy()
        CreateColorSelectionScreen()
    end

    -- Conectar bot√µes
    MobileButton.MouseButton1Click:Connect(function()
        SelectDevice("mobile")
    end)

    PCButton.MouseButton1Click:Connect(function()
        SelectDevice("pc")
    end)

    -- Efeitos hover
    MobileButton.MouseEnter:Connect(function()
        MobileButton.BackgroundColor3 = Color3.fromRGB(80, 80, 255)
    end)

    MobileButton.MouseLeave:Connect(function()
        MobileButton.BackgroundColor3 = Color3.fromRGB(100, 100, 255)
    end)

    PCButton.MouseEnter:Connect(function()
        PCButton.BackgroundColor3 = Color3.fromRGB(50, 100, 255)
    end)

    PCButton.MouseLeave:Connect(function()
        PCButton.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
    end)
end

-- üé® TELA DE SELE√á√ÉO DE COR
local function CreateColorSelectionScreen()
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "ColorSelectionScreen"
    ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
    ScreenGui.ResetOnSpawn = false

    -- Fundo preto
    local BlackBackground = Instance.new("Frame")
    BlackBackground.Size = UDim2.new(1, 0, 1, 0)
    BlackBackground.Position = UDim2.new(0, 0, 0, 0)
    BlackBackground.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    BlackBackground.BackgroundTransparency = 0.2
    BlackBackground.BorderSizePixel = 0
    BlackBackground.ZIndex = 1
    BlackBackground.Parent = ScreenGui

    -- Frame principal
    local MainFrame = Instance.new("Frame")
    MainFrame.Name = "MainFrame"
    MainFrame.Size = UDim2.new(0, 350, 0, 250)
    MainFrame.Position = UDim2.new(0.5, -175, 0.5, -125)
    MainFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    MainFrame.BorderSizePixel = 0
    MainFrame.ClipsDescendants = true
    MainFrame.ZIndex = 2
    MainFrame.Parent = ScreenGui

    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, 20)
    UICorner.Parent = MainFrame

    local UIStroke = Instance.new("UIStroke")
    UIStroke.Color = Color3.fromRGB(100, 100, 255)
    UIStroke.Thickness = 3
    UIStroke.Parent = MainFrame

    -- T√≠tulo
    local TitleLabel = Instance.new("TextLabel")
    TitleLabel.Size = UDim2.new(1, -20, 0, 50)
    TitleLabel.Position = UDim2.new(0, 10, 0, 10)
    TitleLabel.BackgroundTransparency = 1
    TitleLabel.Text = "üé® Selecione a Cor do Tema üé®"
    TitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    TitleLabel.TextSize = 16
    TitleLabel.Font = Enum.Font.GothamBold
    TitleLabel.ZIndex = 3
    TitleLabel.Parent = MainFrame

    -- Bot√µes de cor
    local colors = {
        {name = "azul", color = Color3.fromRGB(0, 100, 255), text = "üîµ Azul"},
        {name = "verde", color = Color3.fromRGB(0, 255, 100), text = "üü¢ Verde"},
        {name = "preto", color = Color3.fromRGB(50, 50, 50), text = "‚ö´ Preto"},
        {name = "transparente", color = Color3.fromRGB(255, 182, 193), text = "üíó Transparente"}
    }

    for i, colorData in ipairs(colors) do
        local ColorButton = Instance.new("TextButton")
        ColorButton.Name = colorData.name .. "Button"
        ColorButton.Size = UDim2.new(0.8, 0, 0, 40)
        ColorButton.Position = UDim2.new(0.1, 0, 0.2 + (i * 0.15), 0)
        ColorButton.BackgroundColor3 = colorData.color
        ColorButton.BorderSizePixel = 0
        ColorButton.Text = colorData.text
        ColorButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        ColorButton.TextSize = 12
        ColorButton.Font = Enum.Font.GothamBold
        ColorButton.ZIndex = 3
        ColorButton.Parent = MainFrame

        local ColorCorner = Instance.new("UICorner")
        ColorCorner.CornerRadius = UDim.new(0, 10)
        ColorCorner.Parent = ColorButton

        local ColorStroke = Instance.new("UIStroke")
        ColorStroke.Color = Color3.fromRGB(255, 255, 255)
        ColorStroke.Thickness = 2
        ColorStroke.Parent = ColorButton

        -- Fun√ß√£o para selecionar cor
        ColorButton.MouseButton1Click:Connect(function()
            SelectedColor = colorData.name
            CurrentTheme = THEME_COLORS[colorData.name]
            ScreenGui:Destroy()
            CreateMainInterface()
        end)

        -- Efeito hover
        ColorButton.MouseEnter:Connect(function()
            ColorButton.BackgroundColor3 = Color3.fromRGB(
                math.min(ColorButton.BackgroundColor3.R * 255 + 30, 255),
                math.min(ColorButton.BackgroundColor3.G * 255 + 30, 255),
                math.min(ColorButton.BackgroundColor3.B * 255 + 30, 255)
            )
        end)

        ColorButton.MouseLeave:Connect(function()
            ColorButton.BackgroundColor3 = colorData.color
        end)
    end
end

-- üß≠ INTERFACE PRINCIPAL
local function CreateMainInterface()
    local interfaceConfig = GetInterfaceConfig(SelectedDevice)
    
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "KitK4tHub"
    ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
    ScreenGui.ResetOnSpawn = false

    -- Frame principal
    local MainFrame = Instance.new("Frame")
    MainFrame.Name = "MainFrame"
    MainFrame.Size = UDim2.new(0, interfaceConfig.width, 0, interfaceConfig.height)
    MainFrame.Position = UDim2.new(0.5, -interfaceConfig.width/2, 0.5, -interfaceConfig.height/2)
    
    if SelectedColor == "transparente" then
        MainFrame.BackgroundColor3 = CurrentTheme.background
        MainFrame.BackgroundTransparency = 0.3
    else
        MainFrame.BackgroundColor3 = CurrentTheme.background
        MainFrame.BackgroundTransparency = 0
    end
    
    MainFrame.BorderSizePixel = 0
    MainFrame.ClipsDescendants = true
    MainFrame.Parent = ScreenGui

    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, 16)
    UICorner.Parent = MainFrame

    -- Efeito de borda brilhante
    local UIStroke = Instance.new("UIStroke")
    UIStroke.Color = CurrentTheme.primary
    UIStroke.Thickness = 3
    UIStroke.Parent = MainFrame

    -- Barra de t√≠tulo
    local TitleBar = Instance.new("Frame")
    TitleBar.Name = "TitleBar"
    TitleBar.Size = UDim2.new(1, -20, 0, interfaceConfig.titleHeight)
    TitleBar.Position = UDim2.new(0, 10, 0, 10)
    TitleBar.BackgroundColor3 = CurrentTheme.primary
    TitleBar.BorderSizePixel = 0
    TitleBar.Parent = MainFrame

    local TitleCorner = Instance.new("UICorner")
    TitleCorner.CornerRadius = UDim.new(0, 12)
    TitleCorner.Parent = TitleBar

    local TitleGradient = Instance.new("UIGradient")
    TitleGradient.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, CurrentTheme.primary),
        ColorSequenceKeypoint.new(1, CurrentTheme.secondary)
    })
    TitleGradient.Parent = TitleBar

    local TitleLabel = Instance.new("TextLabel")
    TitleLabel.Name = "TitleLabel"
    TitleLabel.Size = UDim2.new(1, -50, 1, 0)
    TitleLabel.Position = UDim2.new(0, 15, 0, 0)
    TitleLabel.BackgroundTransparency = 1
    TitleLabel.Text = "üíñ KitK4t Hub - " .. SelectedDevice:upper()
    TitleLabel.TextColor3 = CurrentTheme.text
    TitleLabel.TextSize = interfaceConfig.titleFontSize
    TitleLabel.Font = Enum.Font.GothamBold
    TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
    TitleLabel.TextStrokeTransparency = 0.8
    TitleLabel.TextStrokeColor3 = CurrentTheme.secondary
    TitleLabel.Parent = TitleBar

    -- Bot√£o fechar
    local CloseButton = Instance.new("TextButton")
    CloseButton.Name = "CloseButton"
    CloseButton.Size = UDim2.new(0, 24, 0, 24)
    CloseButton.Position = UDim2.new(1, -30, 0.5, -12)
    CloseButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    CloseButton.BorderSizePixel = 0
    CloseButton.Text = "‚ùå"
    CloseButton.TextColor3 = CurrentTheme.primary
    CloseButton.TextSize = 12
    CloseButton.Font = Enum.Font.GothamBold
    CloseButton.Parent = TitleBar

    local CloseCorner = Instance.new("UICorner")
    CloseCorner.CornerRadius = UDim.new(1, 0)
    CloseCorner.Parent = CloseButton

    -- Conte√∫do principal
    local ContentFrame = Instance.new("Frame")
    ContentFrame.Name = "ContentFrame"
    ContentFrame.Size = UDim2.new(1, 0, 1, -interfaceConfig.titleHeight - 15)
    ContentFrame.Position = UDim2.new(0, 0, 0, interfaceConfig.titleHeight + 10)
    ContentFrame.BackgroundTransparency = 1
    ContentFrame.BorderSizePixel = 0
    ContentFrame.Parent = MainFrame

    -- ScrollingFrame
    local ScrollingFrame = Instance.new("ScrollingFrame")
    ScrollingFrame.Name = "ScrollingFrame"
    ScrollingFrame.Size = UDim2.new(1, -20, 1, -15)
    ScrollingFrame.Position = UDim2.new(0, 10, 0, 10)
    ScrollingFrame.BackgroundTransparency = 1
    ScrollingFrame.BorderSizePixel = 0
    ScrollingFrame.ScrollBarThickness = 4
    ScrollingFrame.ScrollBarImageColor3 = CurrentTheme.primary
    ScrollingFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
    ScrollingFrame.Parent = ContentFrame

    -- TextBox para jogador
    local PlayerTextBox = Instance.new("TextBox")
    PlayerTextBox.Name = "PlayerTextBox"
    PlayerTextBox.Size = UDim2.new(1, 0, 0, interfaceConfig.buttonHeight)
    PlayerTextBox.Position = UDim2.new(0, 0, 0, 0)
    PlayerTextBox.BackgroundColor3 = Color3.fromRGB(255, 250, 250)
    PlayerTextBox.BorderSizePixel = 0
    PlayerTextBox.Text = ""
    PlayerTextBox.PlaceholderText = "‚ú® Digite nome do jogador..."
    PlayerTextBox.TextColor3 = Color3.fromRGB(75, 75, 75)
    PlayerTextBox.PlaceholderColor3 = Color3.fromRGB(200, 150, 160)
    PlayerTextBox.TextSize = interfaceConfig.fontSize
    PlayerTextBox.Font = Enum.Font.Gotham
    PlayerTextBox.TextXAlignment = Enum.TextXAlignment.Left
    PlayerTextBox.Parent = ScrollingFrame

    local TextBoxCorner = Instance.new("UICorner")
    TextBoxCorner.CornerRadius = UDim.new(0, 8)
    TextBoxCorner.Parent = PlayerTextBox

    local TextBoxPadding = Instance.new("UIPadding")
    TextBoxPadding.PaddingLeft = UDim.new(0, 12)
    TextBoxPadding.Parent = PlayerTextBox

    local TextBoxStroke = Instance.new("UIStroke")
    TextBoxStroke.Color = CurrentTheme.primary
    TextBoxStroke.Thickness = 2
    TextBoxStroke.Parent = PlayerTextBox

    -- TextBox para tag personalizada
    local CustomTagTextBox = Instance.new("TextBox")
    CustomTagTextBox.Name = "CustomTagTextBox"
    CustomTagTextBox.Size = UDim2.new(1, 0, 0, interfaceConfig.buttonHeight)
    CustomTagTextBox.Position = UDim2.new(0, 0, 0, interfaceConfig.buttonHeight + 8)
    CustomTagTextBox.BackgroundColor3 = Color3.fromRGB(255, 250, 250)
    CustomTagTextBox.BorderSizePixel = 0
    CustomTagTextBox.Text = ""
    CustomTagTextBox.PlaceholderText = "üè∑Ô∏è Tag personalizada..."
    CustomTagTextBox.TextColor3 = Color3.fromRGB(75, 75, 75)
    CustomTagTextBox.PlaceholderColor3 = Color3.fromRGB(200, 150, 160)
    CustomTagTextBox.TextSize = interfaceConfig.fontSize
    CustomTagTextBox.Font = Enum.Font.Gotham
    CustomTagTextBox.TextXAlignment = Enum.TextXAlignment.Left
    CustomTagTextBox.Parent = ScrollingFrame

    local CustomTagCorner = Instance.new("UICorner")
    CustomTagCorner.CornerRadius = UDim.new(0, 8)
    CustomTagCorner.Parent = CustomTagTextBox

    local CustomTagPadding = Instance.new("UIPadding")
    CustomTagPadding.PaddingLeft = UDim.new(0, 12)
    CustomTagPadding.Parent = CustomTagTextBox

    local CustomTagStroke = Instance.new("UIStroke")
    CustomTagStroke.Color = CurrentTheme.primary
    CustomTagStroke.Thickness = 2
    CustomTagStroke.Parent = CustomTagTextBox

    -- Vari√°vel para jogador selecionado
    local SelectedPlayer = ""

    -- Fun√ß√£o para verificar jogador
    local function CheckPlayerExists(playerName)
        if playerName == "" then return false end
        return Players:FindFirstChild(playerName) ~= nil
    end

    -- Sistema de autocompletar no TextBox
    PlayerTextBox:GetPropertyChangedSignal("Text"):Connect(function()
        local text = PlayerTextBox.Text
        if text ~= "" then
            local completedName = AutoCompleteName(text)
            if completedName and completedName ~= text then
                PlayerTextBox.PlaceholderText = "üí´ Sugest√£o: " .. completedName
            else
                PlayerTextBox.PlaceholderText = "‚ú® Digite nome do jogador..."
            end
        else
            PlayerTextBox.PlaceholderText = "‚ú® Digite nome do jogador..."
        end
    end)

    -- Efeitos no TextBox
    PlayerTextBox.FocusLost:Connect(function(enterPressed)
        if enterPressed then
            local playerName = string.gsub(PlayerTextBox.Text, "^%s*(.-)%s*$", "%1")
            
            -- Tentar autocompletar antes de verificar
            if playerName ~= "" then
                local completedName = AutoCompleteName(playerName)
                if completedName then
                    playerName = completedName
                    PlayerTextBox.Text = completedName
                end
            end
            
            if CheckPlayerExists(playerName) then
                SelectedPlayer = playerName
                PlayerTextBox.BackgroundColor3 = Color3.fromRGB(230, 255, 230)
                PlayerTextBox.UIStroke.Color = Color3.fromRGB(144, 238, 144)
            else
                PlayerTextBox.BackgroundColor3 = Color3.fromRGB(255, 230, 230)
                PlayerTextBox.UIStroke.Color = CurrentTheme.primary
            end
        end
    end)

    -- Lista de comandos
    local commands = {
        {Name="üòé Kick", Command="kick"},
        {Name="üîÅ LoopKill", Command="loopkill"},
        {Name="üíÄ Kill+", Command="killplus"},
        {Name="üåÄ Fling", Command="fling"},
        {Name="‚ùÑÔ∏è Freeze", Command="freeze"},
        {Name="üî• Unfreeze", Command="unfreeze"},
        {Name="üì¶ Bring", Command="bring"},
        {Name="‚úÖ Verifique", Command="verifique"},
        {Name="üè∑Ô∏è Tags", Command="tags"},
        {Name="üîñ SelTag", Command="selecttag"},
        {Name="‚ùå Untag", Command="untag"}
    }

    -- Criar bot√µes
    local buttonHeight = interfaceConfig.buttonHeight
    local spacing = 6
    local totalHeight = (interfaceConfig.buttonHeight + 8) * 2 + spacing

    for i, cmd in ipairs(commands) do
        local Button = Instance.new("TextButton")
        Button.Name = cmd.Command .. "Button"
        Button.Size = UDim2.new(1, 0, 0, buttonHeight)
        Button.Position = UDim2.new(0, 0, 0, totalHeight)
        Button.BackgroundColor3 = Color3.fromRGB(255, 250, 250)
        Button.BorderSizePixel = 0
        Button.Text = cmd.Name
        Button.TextColor3 = Color3.fromRGB(75, 75, 75)
        Button.TextSize = interfaceConfig.fontSize
        Button.Font = Enum.Font.GothamSemibold
        Button.Parent = ScrollingFrame

        local ButtonCorner = Instance.new("UICorner")
        ButtonCorner.CornerRadius = UDim.new(0, 10)
        ButtonCorner.Parent = Button

        local ButtonStroke = Instance.new("UIStroke")
        ButtonStroke.Color = CurrentTheme.primary
        ButtonStroke.Thickness = 2
        ButtonStroke.Parent = Button

        -- Efeito hover
        Button.MouseEnter:Connect(function()
            Button.BackgroundColor3 = CurrentTheme.primary
            Button.TextColor3 = CurrentTheme.text
            Button.UIStroke.Color = CurrentTheme.secondary
        end)

        Button.MouseLeave:Connect(function()
            Button.BackgroundColor3 = Color3.fromRGB(255, 250, 250)
            Button.TextColor3 = Color3.fromRGB(75, 75, 75)
            Button.UIStroke.Color = CurrentTheme.primary
        end)

        -- A√ß√£o do bot√£o
        Button.MouseButton1Click:Connect(function()
            if SelectedPlayer == "" and cmd.Command ~= "verifique" and cmd.Command ~= "tags" and cmd.Command ~= "selecttag" and cmd.Command ~= "untag" then
                local originalText = Button.Text
                Button.Text = "‚ùå Digite um nome!"
                Button.BackgroundColor3 = Color3.fromRGB(255, 200, 200)
                task.wait(0.8)
                Button.Text = originalText
                Button.BackgroundColor3 = Color3.fromRGB(255, 250, 250)
                return
            end

            if cmd.Command == "verifique" then
                SendCommandMessage(cmd.Command)
            elseif cmd.Command == "tags" then
                ApplySpecialTag(SelectedPlayer)
                Button.Text = "üíñ Tag Aplicada!"
                Button.BackgroundColor3 = Color3.fromRGB(144, 238, 144)
                task.wait(0.5)
                Button.Text = cmd.Name
                Button.BackgroundColor3 = Color3.fromRGB(255, 250, 250)
            elseif cmd.Command == "selecttag" then
                ApplyCustomTag(SelectedPlayer, CustomTagTextBox.Text)
                Button.Text = "üíñ Tag Personalizada!"
                Button.BackgroundColor3 = Color3.fromRGB(144, 238, 144)
                task.wait(0.5)
                Button.Text = cmd.Name
                Button.BackgroundColor3 = Color3.fromRGB(255, 250, 250)
            elseif cmd.Command == "untag" then
                RemovePlayerTag(SelectedPlayer)
                Button.Text = "üíî Tag Removida!"
                Button.BackgroundColor3 = Color3.fromRGB(255, 200, 200)
                task.wait(0.5)
                Button.Text = cmd.Name
                Button.BackgroundColor3 = Color3.fromRGB(255, 250, 250)
            else
                SendCommandMessage(cmd.Command, SelectedPlayer)
                Button.Text = "‚ú® Executado!"
                Button.BackgroundColor3 = CurrentTheme.primary
                task.wait(0.3)
                Button.Text = cmd.Name
                Button.BackgroundColor3 = Color3.fromRGB(255, 250, 250)
            end
        end)

        totalHeight = totalHeight + buttonHeight + spacing
    end

    -- Atualizar tamanho do canvas
    ScrollingFrame.CanvasSize = UDim2.new(0, 0, 0, totalHeight)

    -- Sistema para mover a janela
    local dragging = false
    local dragStart, startPos

    TitleBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = MainFrame.Position
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
            local delta = input.Position - dragStart
            MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)

    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = false
        end
    end)

    -- Bot√£o fechar
    CloseButton.MouseButton1Click:Connect(function()
        ScreenGui:Destroy()
    end)

    -- Efeitos de hover no bot√£o fechar
    CloseButton.MouseEnter:Connect(function()
        CloseButton.BackgroundColor3 = CurrentTheme.secondary
    end)

    CloseButton.MouseLeave:Connect(function()
        CloseButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    end)

    -- Efeito especial quando abre
    CreateThemeEffect()
end

-- üöÄ INICIAR SISTEMA
task.spawn(function()
    task.wait(1)
    CreateDeviceSelectionScreen()
end)
